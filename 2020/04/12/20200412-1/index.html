<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/parrot.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/parrot.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('https://lucaseo.github.io').hostname,
    root: '/',
    scheme: 'Muse',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"flat"},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="Who’s Good에서는 서로 다른 직무의 팀원 간의 협업이 매우 긴밀하게 이루어집니다. 2019년 말, “대체 언제까지 슬랙으로 엑셀 파일을 주고 받아야 하는가?”에 대한 해답을 찾던 중, 구글 스프레드시트(Google Spreadsheet)와 연동하는 것으로 몇가지 고민을 해결할 수 있게 되었습니다. 이번 포스트에서는 Python을 통해서 구글 스프레드">
<meta property="og:type" content="article">
<meta property="og:title" content="[KR] Python으로 구글 스프레드시트 연동하기 (ft. gspread)">
<meta property="og:url" content="https://lucaseo.github.io/2020/04/12/20200412-1/index.html">
<meta property="og:site_name" content="Blog">
<meta property="og:description" content="Who’s Good에서는 서로 다른 직무의 팀원 간의 협업이 매우 긴밀하게 이루어집니다. 2019년 말, “대체 언제까지 슬랙으로 엑셀 파일을 주고 받아야 하는가?”에 대한 해답을 찾던 중, 구글 스프레드시트(Google Spreadsheet)와 연동하는 것으로 몇가지 고민을 해결할 수 있게 되었습니다. 이번 포스트에서는 Python을 통해서 구글 스프레드">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/1.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/2.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/3.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/4.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/5.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/6.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/7.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/8.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/9.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/10.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/11.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/12.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/13.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/14.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/15.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/16.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/17.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/18.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/19.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/20.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/21.png">
<meta property="og:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/22.png">
<meta property="article:published_time" content="2020-04-12T04:23:21.000Z">
<meta property="article:modified_time" content="2020-04-26T14:42:41.877Z">
<meta property="article:author" content="SEO Wonyoung">
<meta property="article:tag" content="python">
<meta property="article:tag" content="google spreadsheet">
<meta property="article:tag" content="gspread">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://lucaseo.github.io/2020/04/12/20200412-1/1.png">

<link rel="canonical" href="https://lucaseo.github.io/2020/04/12/20200412-1/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>[KR] Python으로 구글 스프레드시트 연동하기 (ft. gspread) | Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">from swy</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="en">
    <link itemprop="mainEntityOfPage" href="https://lucaseo.github.io/2020/04/12/20200412-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="SEO Wonyoung">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          [KR] Python으로 구글 스프레드시트 연동하기 (ft. gspread)
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-12 13:23:21" itemprop="dateCreated datePublished" datetime="2020-04-12T13:23:21+09:00">2020-04-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-04-26 23:42:41" itemprop="dateModified" datetime="2020-04-26T23:42:41+09:00">2020-04-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>Who’s Good에서는 서로 다른 직무의 팀원 간의 협업이 매우 긴밀하게 이루어집니다. 2019년 말, “대체 언제까지 슬랙으로 엑셀 파일을 주고 받아야 하는가?”에 대한 해답을 찾던 중, 구글 스프레드시트(Google Spreadsheet)와 연동하는 것으로 몇가지 고민을 해결할 수 있게 되었습니다. 이번 포스트에서는 Python을 통해서 구글 스프레드시트와 연동하는 과정을 다룬 사내 튜토리얼을 다시 정리해보았습니다.</p>
<a id="more"></a>
<hr>
<p>Who’s Good에서는 리서쳐와 분석가/개발자 간에 데이터를 주고 받는 일이 매우 빈번하다. 특히 기업 관련 뉴스 데이터와, 다양한 소스로부터 수집하는 ESG 관련 데이터에 대한 QC를 진행하고 결과를 DB에 적재하는 과정이 있는데, 엑셀에서 작업한 데이터를 저장하고, 슬랙으로 전달하는 여러 단계와 여러 사람들을 거치다 보니 주고받은 파일명이 뒤죽박죽인 아주 원초(?)적인 문제부터, 데이터가 언제 업데이트 되었는지 추적이 불가능한 상황도 발생하면서 마음 한 켠에 찝찝함이 남아있는 나날이 계속 되었다. 언제 어디선가 불시에 문제가 생기지는 않을까 하는 두려움. 하지만 아무도 두려워하지 않는 듯해 보여서 더 두려운 고요한 두려움.</p>
<p>두려움을 떨쳐내려 방법을 찾기 시작한 지 얼마 지나지 않아, <strong>gspread</strong>라는 라이브러리를 찾게 되었다. 별 거 아닌데, 왜 여태 사용해보지 않았을까. 이거다 싶었다. </p>
<p><img src="/2020/04/12/20200412-1/1.png" alt=""></p>
<p>바로 적용한 아주 간단한 예시를 들자면, 리서쳐들이 구글 스프레드시트에서 작업한 것들을 DB에 적재하는 과정을 자동화할 수 있었고, 데이터를 누가 작업했고, 업데이트가 되었는지에 대한 여부 또한 스프레드시트를 기반으로 작업하게 되니 해결 되었다. </p>
<p>생각보다 간단했던 Python과 구글 스프레드시트를 연동하는 과정을 알아보자.</p>
<p><br><br><br></p>
<h1 id="튜토리얼"><a href="#튜토리얼" class="headerlink" title="튜토리얼"></a>튜토리얼</h1><h2 id="GCP에서-사용자-인증-설정"><a href="#GCP에서-사용자-인증-설정" class="headerlink" title="GCP에서 사용자 인증 설정"></a>GCP에서 사용자 인증 설정</h2><p>Python으로 스프레드시트를 연동하기 위해서는, GCP(Google Cloud Platform)에서 사용자 인증과 API 사용 인증이 준비되어야 한다.</p>
<p><br></p>
<h3 id="구글-클라우드-플랫폼에-로그인"><a href="#구글-클라우드-플랫폼에-로그인" class="headerlink" title="구글 클라우드 플랫폼에 로그인"></a>구글 클라우드 플랫폼에 로그인</h3><ul>
<li>회사에서는 팀원들과 드라이브를 공유하기에 Gsuite 계정으로 로그인했다. </li>
</ul>
<p><img src="/2020/04/12/20200412-1/2.png" alt=""></p>
<p><br></p>
<h3 id="새로운-프로젝트-생성"><a href="#새로운-프로젝트-생성" class="headerlink" title="새로운 프로젝트 생성"></a>새로운 프로젝트 생성</h3><ul>
<li>구글 드라이브, 구글 스프레드시트와 연동할 새로운 프로젝트를 새로 생성한다. </li>
</ul>
<p><img src="/2020/04/12/20200412-1/3.png" alt=""><br><img src="/2020/04/12/20200412-1/4.png" alt=""><br><img src="/2020/04/12/20200412-1/5.png" alt=""><br><img src="/2020/04/12/20200412-1/6.png" alt=""></p>
<p><br></p>
<h3 id="구글-드라이브-API-사용-설정"><a href="#구글-드라이브-API-사용-설정" class="headerlink" title="구글 드라이브 API 사용 설정"></a>구글 드라이브 API 사용 설정</h3><ul>
<li>새로 생성한 프로젝트를 선택하고, API 개요 이동하여 구글 드라이브 API 사용을 설정한다.<br><img src="/2020/04/12/20200412-1/7.png" alt=""><br><img src="/2020/04/12/20200412-1/8.png" alt=""><br><img src="/2020/04/12/20200412-1/9.png" alt=""><br><img src="/2020/04/12/20200412-1/10.png" alt=""><br><img src="/2020/04/12/20200412-1/11.png" alt=""><br><img src="/2020/04/12/20200412-1/12.png" alt=""></li>
</ul>
<p><br></p>
<h3 id="구글-드라이브-API에-대한-인증정보-생성"><a href="#구글-드라이브-API에-대한-인증정보-생성" class="headerlink" title="구글 드라이브 API에 대한 인증정보 생성."></a>구글 드라이브 API에 대한 인증정보 생성.</h3><ul>
<li>구글 드라이브 API를 사용함에 있어서 필요한 사용자 인증정보를 추가한다.</li>
<li>새 서비스 계정을 만들면, 서비스 계정 및 키가 JSON 형태의 파일이 받아지게 된다.<ul>
<li>특히 추후 파이썬 코드 내에서 키가 필요하게 되니, 적절한 디렉토리에 저장하도록 한다.<br><img src="/2020/04/12/20200412-1/13.png" alt=""><br><img src="/2020/04/12/20200412-1/14.png" alt=""><br><img src="/2020/04/12/20200412-1/15.png" alt=""><br><img src="/2020/04/12/20200412-1/16.png" alt=""></li>
</ul>
</li>
</ul>
<p><br></p>
<h3 id="구글-스프레드시트-API-사용-설정"><a href="#구글-스프레드시트-API-사용-설정" class="headerlink" title="구글 스프레드시트 API 사용 설정"></a>구글 스프레드시트 API 사용 설정</h3><ul>
<li>구글 드라이브 API 사용 설정한 방법과 동일하게, 구글 스프레드시트 API 사용설정을 활성화 한다.</li>
</ul>
<p><img src="/2020/04/12/20200412-1/17.png" alt=""><br><img src="/2020/04/12/20200412-1/18.png" alt=""></p>
<p><br></p>
<h2 id="파이썬-패키지-설치"><a href="#파이썬-패키지-설치" class="headerlink" title="파이썬 패키지 설치"></a>파이썬 패키지 설치</h2><ul>
<li>파이썬에서는 <code>gspread</code>와 <code>oauth2client</code>가 필요하다.<ul>
<li><code>gspread</code>: 파이썬을 통해 구글 스프레드시트와 연동하고, 제어할 수 있게 하는 패키지.</li>
<li><code>oauth2client</code>: OAuth2을 통해 사용자 인증을 하기 위해 설치함.</li>
</ul>
</li>
<li><p>터미널 또는 CMD에서 pip를 통해 설치하도록 한다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install gspread</span><br><span class="line">pip install --upgrade oauth2client</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br></p>
<h2 id="구글-스프레드시트-파일-설정"><a href="#구글-스프레드시트-파일-설정" class="headerlink" title="구글 스프레드시트 파일 설정"></a>구글 스프레드시트 파일 설정</h2><ul>
<li>파이썬을 통해서 접근하고 연동하고자 하는 해당 구글 시트에서 사용자 인증 정보를 설정하다. </li>
<li>앞서 내려 받은 JSON파일에서 <code>client_email</code>의 값을 복사한 뒤, 해당 스프레드시트 우측 상단 <code>공유</code>를 클릭한 뒤 입력하여 권한을 부여한다..</li>
</ul>
<p><img src="/2020/04/12/20200412-1/19.png" alt=""><br><img src="/2020/04/12/20200412-1/20.png" alt=""></p>
<ul>
<li>복잡하지는 않지만, 스프레드시트마다 이 작업을 해주어야 한다는 점이 약간 번거로운 부분이다.</li>
<li>공유 권한부여까지 완료되었다면, 이제 파이썬으로 스프레드시트의 데이터를 읽어와보자!</li>
</ul>
<p><br><br><br></p>
<h2 id="파이썬에서-테스트"><a href="#파이썬에서-테스트" class="headerlink" title="파이썬에서 테스트"></a>파이썬에서 테스트</h2><h3 id="인증과-연동"><a href="#인증과-연동" class="headerlink" title="인증과 연동"></a>인증과 연동</h3><ul>
<li>사용자 인증 파일(<code>JSON</code>)을 통해 연동을 한다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> oauth2client.service_account <span class="keyword">import</span> ServiceAccountCredentials</span><br><span class="line"></span><br><span class="line">scope = [<span class="string">"https://spreadsheets.google.com/feeds"</span>,</span><br><span class="line">         <span class="string">"https://www.googleapis.com/auth/spreadsheets"</span>,</span><br><span class="line">         <span class="string">"https://www.googleapis.com/auth/drive.file"</span>,</span><br><span class="line">         <span class="string">"https://www.googleapis.com/auth/drive"</span>]</span><br><span class="line"></span><br><span class="line">creds = ServiceAccountCredentials.from_json_keyfile_name(<span class="string">"&#123;your_JSON_filename&#125;.json"</span>, scope)</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="스프레드-시트-선택"><a href="#스프레드-시트-선택" class="headerlink" title="스프레드 시트 선택"></a>스프레드 시트 선택</h3><ul>
<li>테스트를 위해서 샘플 스프레드시트를 생성한 상태이다.<ul>
<li>빈 시트인 <code>시트1</code>, 그리고 상장기업종목코드와 기업명이 담긴 <code>sample_data</code> 시트가 있다.</li>
</ul>
</li>
</ul>
<p><img src="/2020/04/12/20200412-1/21.png" alt=""></p>
<ul>
<li><code>gspread</code> 패키지를 통해 인증 후, 접근하고자 하는 시트의 이름을 패스한다. </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gspread</span><br><span class="line"></span><br><span class="line">spreadsheet_name = <span class="string">"&#123;your target spreadsheet name&#125;"</span></span><br><span class="line">client = gspread.authorize(creds)</span><br><span class="line">spreadsheet = client.open(spreadsheet_name)</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="시트-불러오기"><a href="#시트-불러오기" class="headerlink" title="시트 불러오기"></a>시트 불러오기</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> sheet <span class="keyword">in</span> spreadsheet.worksheets():</span><br><span class="line">    print(sheet)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;Worksheet &#39;시트1&#39; id:1966713574&gt;</span><br><span class="line">&lt;Worksheet &#39;sample_data&#39; id:0&gt;</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="시트-선택하기"><a href="#시트-선택하기" class="headerlink" title="시트 선택하기"></a>시트 선택하기</h3><ul>
<li>이름 또는 인덱스를 통해 시트를 선택할 수 있다.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## by name</span></span><br><span class="line">sheet = spreadsheet.worksheet(<span class="string">"sample_data"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">## OR by index</span></span><br><span class="line">sheet = spreadsheet.get_worksheet(<span class="number">1</span>)</span><br><span class="line">print(sheet)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Worksheet &#39;sample_data&#39; id:0&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<h3 id="시트-내-데이터-읽어오기"><a href="#시트-내-데이터-읽어오기" class="headerlink" title="시트 내 데이터 읽어오기"></a>시트 내 데이터 읽어오기</h3><ul>
<li><code>get_all_values()</code> 함수는 시트 내 데이터를 모두 출력한다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sheet.get_all_records()[:<span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[&#123;&#39;CompanyStockCode&#39;: &#39;S030190&#39;,</span><br><span class="line">  &#39;PA_CompanyID&#39;: 1,</span><br><span class="line">  &#39;IA_CompanyID&#39;: &#39;ID00001&#39;,</span><br><span class="line">  &#39;DelistStatus&#39;: &#39;&#39;,</span><br><span class="line">  &#39;CompanyKorName&#39;: &#39;NICE평가정보&#39;&#125;,</span><br><span class="line"> &#123;&#39;CompanyStockCode&#39;: &#39;S038620&#39;,</span><br><span class="line">  &#39;PA_CompanyID&#39;: 2,</span><br><span class="line">  &#39;IA_CompanyID&#39;: &#39;ID00002&#39;,</span><br><span class="line">  &#39;DelistStatus&#39;: &#39;&#39;,</span><br><span class="line">  &#39;CompanyKorName&#39;: &#39;위즈코프&#39;&#125;,</span><br><span class="line"> &#123;&#39;CompanyStockCode&#39;: &#39;S039020&#39;,</span><br><span class="line">  &#39;PA_CompanyID&#39;: 3,</span><br><span class="line">  &#39;IA_CompanyID&#39;: &#39;ID00003&#39;,</span><br><span class="line">  &#39;DelistStatus&#39;: &#39;&#39;,</span><br><span class="line">  &#39;CompanyKorName&#39;: &#39;이건홀딩스&#39;&#125;]</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="Pandas-DataFrame-형태로-변환"><a href="#Pandas-DataFrame-형태로-변환" class="headerlink" title="Pandas DataFrame 형태로 변환"></a>Pandas DataFrame 형태로 변환</h3><ul>
<li>간단한 함수를 작성하여 Pandas의 DataFrame형태로 데이터를 불러올 수 있다.<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def gsheet2df(sheet):</span><br><span class="line">    df &#x3D; pd.DataFrame(columns&#x3D;list(sheet.get_all_records()[0].keys()))</span><br><span class="line">    for item in sheet.get_all_records():</span><br><span class="line">        df.loc[len(df)] &#x3D; item</span><br><span class="line">    return df</span><br><span class="line"></span><br><span class="line">df_sample_data &#x3D; gsheet2df(sheet)</span><br><span class="line">df_sample_data.head()</span><br></pre></td></tr></table></figure>
<img src="/2020/04/12/20200412-1/22.png" alt=""></li>
</ul>
<p><br><br><br></p>
<h1 id="마무리하며"><a href="#마무리하며" class="headerlink" title="마무리하며"></a>마무리하며</h1><p> 리서쳐와 데이터를 주고 받으며 일하던 와중에, <code>gspread</code>의 적용은 매우 빛과 소금 같은 시원한, 그리고 매우 신속했던 해결책이었다. 내 업무영역에 적용한 뒤, 바로 다른 분석가 동료들에게 튜토리얼을 통해 공유하는 세션을 가지기도 했던 만큼 적용되는 범위가 컸다.</p>
<p> 누구든 일을 하다 잠재적인 기술 부채를 맞닥뜨리면, 미래의 나를 위해서 어떻게든 털어내버리고 싶을 것이다. 하지만, 함께 해결해나갈 인력이 없는 환경에서 비개발자인 동료들도 불편해하지 않게끔 적절한 방법을 찾고 도입하는 것은 생각보다 쉽지 않았다. 답답할 때가 없지는 않지만, 이번 케이스처럼 또 하나하나씩 도입해나가면 더 매끄러워지지 않을까라는 생각을 해보며 또 다른 기술 부채를 맞닥뜨릴 마음의 준비를 해본다.</p>
<p><br></p>
<hr>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul>
<li><p><a href="https://gspread.readthedocs.io/en/latest/" target="_blank" rel="noopener">gspread 공식 도큐먼트</a></p>
</li>
<li><p><a href="https://medium.com/@CROSP/manage-google-spreadsheets-with-python-and-gspread-6530cc9f15d1" target="_blank" rel="noopener">Manage Google Spreadsheets with Python and Gspread</a></p>
</li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/python/" rel="tag"># python</a>
              <a href="/tags/google-spreadsheet/" rel="tag"># google spreadsheet</a>
              <a href="/tags/gspread/" rel="tag"># gspread</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/03/29/20200329-1/" rel="prev" title="[KR] Streamlit 웹 어플리케이션 배포하기 (feat. Heroku)">
      <i class="fa fa-chevron-left"></i> [KR] Streamlit 웹 어플리케이션 배포하기 (feat. Heroku)
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/04/23/20200423-1/" rel="next" title="[KR] 추천시스템의 평가 지표 : MAP">
      [KR] 추천시스템의 평가 지표 : MAP <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#튜토리얼"><span class="nav-number">1.</span> <span class="nav-text">튜토리얼</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#GCP에서-사용자-인증-설정"><span class="nav-number">1.1.</span> <span class="nav-text">GCP에서 사용자 인증 설정</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#구글-클라우드-플랫폼에-로그인"><span class="nav-number">1.1.1.</span> <span class="nav-text">구글 클라우드 플랫폼에 로그인</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#새로운-프로젝트-생성"><span class="nav-number">1.1.2.</span> <span class="nav-text">새로운 프로젝트 생성</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#구글-드라이브-API-사용-설정"><span class="nav-number">1.1.3.</span> <span class="nav-text">구글 드라이브 API 사용 설정</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#구글-드라이브-API에-대한-인증정보-생성"><span class="nav-number">1.1.4.</span> <span class="nav-text">구글 드라이브 API에 대한 인증정보 생성.</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#구글-스프레드시트-API-사용-설정"><span class="nav-number">1.1.5.</span> <span class="nav-text">구글 스프레드시트 API 사용 설정</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#파이썬-패키지-설치"><span class="nav-number">1.2.</span> <span class="nav-text">파이썬 패키지 설치</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#구글-스프레드시트-파일-설정"><span class="nav-number">1.3.</span> <span class="nav-text">구글 스프레드시트 파일 설정</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#파이썬에서-테스트"><span class="nav-number">1.4.</span> <span class="nav-text">파이썬에서 테스트</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#인증과-연동"><span class="nav-number">1.4.1.</span> <span class="nav-text">인증과 연동</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#스프레드-시트-선택"><span class="nav-number">1.4.2.</span> <span class="nav-text">스프레드 시트 선택</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#시트-불러오기"><span class="nav-number">1.4.3.</span> <span class="nav-text">시트 불러오기</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#시트-선택하기"><span class="nav-number">1.4.4.</span> <span class="nav-text">시트 선택하기</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#시트-내-데이터-읽어오기"><span class="nav-number">1.4.5.</span> <span class="nav-text">시트 내 데이터 읽어오기</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Pandas-DataFrame-형태로-변환"><span class="nav-number">1.4.6.</span> <span class="nav-text">Pandas DataFrame 형태로 변환</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#마무리하며"><span class="nav-number">2.</span> <span class="nav-text">마무리하며</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Reference"><span class="nav-number">3.</span> <span class="nav-text">Reference</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">SEO Wonyoung</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">24</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/in/lucaseo/" title="Linkedin → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;lucaseo&#x2F;" rel="noopener" target="_blank"><i class="fa fa-fw fa-linkedin"></i>Linkedin</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://github.com/lucaseo" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;lucaseo" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:lucaseo0147@gmail.com" title="E-Mail → mailto:lucaseo0147@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">SEO Wonyoung</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

</body>
</html>
